--- a/net/sched/sch_api.c
+++ b/net/sched/sch_api.c
@@ -1109,6 +1109,11 @@ skip:
 			return -EINVAL;
 		}
 
+		if (new && new->ops == &noqueue_qdisc_ops) {
+			NL_SET_ERR_MSG(extack, "Cannot assign noqueue to a class");
+			return -EINVAL;
+		}
+
 		err = cops->graft(parent, cl, new, &old, extack);
 		if (err)
 			return err;
