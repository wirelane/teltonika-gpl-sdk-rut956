(function(c,l){typeof exports=="object"&&typeof module<"u"?module.exports=l():typeof define=="function"&&define.amd?define(l):(c=typeof globalThis<"u"?globalThis:c||self,c["services/SnmpV3_js"]=l())})(this,function(){"use strict";function c(s,e,i,a,t,o,h,b){var n=typeof s=="function"?s.options:s;e&&(n.render=e,n.staticRenderFns=i,n._compiled=!0),a&&(n.functional=!0),o&&(n._scopeId="data-v-"+o);var u;if(h?(u=function(r){r=r||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!r&&typeof __VUE_SSR_CONTEXT__<"u"&&(r=__VUE_SSR_CONTEXT__),t&&t.call(this,r),r&&r._registeredComponents&&r._registeredComponents.add(h)},n._ssrRegister=u):t&&(u=b?function(){t.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:t),u)if(n.functional){n._injectStyles=u;var M=n.render;n.render=function(A,p){return u.call(p),M(A,p)}}else{var m=n.beforeCreate;n.beforeCreate=m?[].concat(m,u):[u]}return{exports:s,options:n}}const l={props:{section:{type:Object,required:!0}},data(){return{formData:{users:[]},seclevels:[["noauth",this.$t("No authentication, no privacy")],["auth",this.$t("Authentication, no privacy")],["priv",this.$t("Authentication and privacy")]],rights:[["ro",this.$t("Read-Only")],["rw",this.$t("Read-Write")]],authenticationTypes:[["SHA",this.$t("SHA")],["MD5",this.$t("MD5")]],privacyTypes:[["DES",this.$t("DES")],["AES",this.$t("AES128")]]}},methods:{getCipherWarning(s){if(s==="DES")return this.$t("This privacy type is not considered secure. Consider using a more secure privacy type, such as AES.")},validateUsername(s){return this.formData.users.filter(i=>i.username===s).length<2?{isValid:!0}:{isValid:!1,message:this.$t("Username '%s' already exists.").format(s)}}}};var d=function(){var e=this,i=e._self._c;return i("vuci-form",{attrs:{config:"snmpd",editing:""},scopedSlots:e._u([{key:"default",fn:function({uciData:a}){return[i("vuci-named-section",{attrs:{"uci-data":a,name:e.section.id,title:e.$t("SNMP V3 User"),help:e.$t("This section is used to configure the settings of a SNMP user. Scroll your mouse pointer over field names in order to see helpful hints."),"data-key":"users",endpoints:[{endpoint:"snmp/users/config"}]},scopedSlots:e._u([{key:"default",fn:function({s:t}){return[i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Enable"),help:e.$t("Enable SNMP user configuration."),name:"enabled"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Username"),help:e.$t("Name of the SNMP user configuration."),name:"username",required:"",rules:["uciname",e.validateUsername],maxlength:"32"}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Access mode"),help:e.$t("Access mode specifies which access the host has in the community and if they are allowed to retrieve and modify MIB variables from a specific SNMP agent."),name:"rights",options:e.rights}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("MIB subtree"),help:e.$t("Leave empty to access full MIB tree."),name:"mibaccess",rules:"string",maxlength:"16",placeholder:".1"}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Security level"),help:`${e.$t("A security level is an authentication strategy that is set up for the user. No authentication, no privacy - authenticates with a username.")}         </br> ${e.$t("Authentication - provides MD5 or SHA algorithms for authentication.")}         </br> ${e.$t("Privacy - Provides DES or AES encryption.")}`,name:"seclevel",options:e.seclevels,rawhtml:""}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Authentication type"),help:e.$t("Set authentication type to use with SNMPv3."),name:"authtype",options:e.authenticationTypes,depend:t.seclevel!=="noauth"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Authentication passphrase"),help:e.$t("Set authentication passphrase to generate key for SNMPv3."),name:"authpass",password:"",placeholder:"Passphrase",depend:t.seclevel!=="noauth",rules:"uciname",minlength:"8",maxlength:"64",required:t.enabled==="1"}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Privacy type"),help:e.$t("Set privacy type to use with SNMPv3."),name:"privtype",options:e.privacyTypes,warnings:e.getCipherWarning,depend:t.seclevel==="priv"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Privacy passphrase"),help:e.$t("Set privacy passpharse to generate key for SNMPv3."),name:"privpass",password:"",placeholder:"Passphrase",depend:t.seclevel==="priv",rules:"uciname",minlength:"8",maxlength:"64",required:t.enabled==="1"}})]}}],null,!0)})]}}]),model:{value:e.formData,callback:function(a){e.formData=a},expression:"formData"}})},f=[],v=c(l,d,f,!1,null,null,null,null);const y=v.exports,$={data(){return{editForm:y,formData:{users:[]},userColumns:[{name:"username",label:this.$t("Username"),help:this.$t("Set username to access SNMP.")},{name:"seclevel",label:this.$t("Security level"),help:this.$t("A security level is an authentication strategy that is set up for the user.")},{name:"authtype",label:this.$t("Authentication type"),help:this.$t("Set authentication type to use with SNMPv3.")},{name:"privtype",label:this.$t("Encryption type"),help:this.$t("Set encryption type to use with SNMPv3.")},{name:"rights",label:this.$t("Access mode"),help:this.$t("Access mode specifies which access the host has in the community and if they are allowed to retrieve and modify MIB variables from a specific SNMP agent.")},{name:"enabled"}],securityLevels:{noauth:this.$t("No authentication, no privacy"),auth:this.$t("Authentication, no privacy"),priv:this.$t("Authentication and privacy")},rights:{ro:this.$t("Read-Only"),rw:this.$t("Read-Write")}}},methods:{validateUsers(s){return this.formData.users.some(e=>e.username===s)?{isValid:!1,message:this.$t("Username '%s' already exists.").format(s)}:{isValid:!0}},validateEnable(s){const e=s.uciSection;if(s.model==="0"||e.enabled!=="1")return;const i=[];e.rights||i.push(this.$t("Access mode")),e.seclevel||i.push(this.$t("Security level")),(e.seclevel==="auth"||e.seclevel==="priv")&&!e.authpass&&i.push(this.$t("Authentication passphrase")),e.seclevel==="priv"&&!e.privpass&&i.push(this.$t("Privacy passphrase")),i.length===1&&(this.$message.error(this.$t("Missing required option: %s").format(i)),s.model="0"),i.length>1&&(this.$message.error(this.$t("Missing required options: %s").format(i.join(", "))),s.model="0")}}};var g=function(){var e=this,i=e._self._c;return i("vuci-form",{attrs:{config:"snmpd"},scopedSlots:e._u([{key:"default",fn:function({uciData:a}){return[i("vuci-typed-section",{attrs:{"uci-data":a,"edit-form":e.editForm,columns:e.userColumns,endpoints:[{endpoint:"snmp/users/config"}],title:e.$t("SNMP v3 users"),help:e.$t("This section displays SNMP user configurations currently existing on the device."),type:"user","data-key":"users"},scopedSlots:e._u([{key:"username",fn:function({s:t}){return[i("vuci-form-item-dummy",{attrs:{"uci-section":t,name:"username"}})]}},{key:"seclevel",fn:function({s:t}){return[i("vuci-form-item-dummy",{attrs:{"uci-section":t,"display-value":o=>e.securityLevels[o],name:"seclevel"}})]}},{key:"authtype",fn:function({s:t}){return[i("vuci-form-item-dummy",{attrs:{"uci-section":t,name:"authtype"}})]}},{key:"privtype",fn:function({s:t}){return[i("vuci-form-item-dummy",{attrs:{"uci-section":t,name:"privtype"}})]}},{key:"rights",fn:function({s:t}){return[i("vuci-form-item-dummy",{attrs:{"uci-section":t,"display-value":o=>e.rights[o],name:"rights"}})]}},{key:"enabled",fn:function({s:t}){return[i("vuci-form-item-switch",{attrs:{"uci-section":t,name:"enabled"},on:{change:e.validateEnable}})]}},{key:"addForm",fn:function({addModel:t}){return[i("tlt-form-item-input",{attrs:{label:e.$t("Username"),help:e.$t("This section is used to create a new SNMP user configuration. To add a new SNMP user, enter a custom name and click the 'Add' button."),rules:["uciname",e.validateUsers],maxlength:"32",prop:"username",required:""},model:{value:t.username,callback:function(o){e.$set(t,"username",o)},expression:"addModel.username"}})]}}],null,!0)})]}}]),model:{value:e.formData,callback:function(a){e.formData=a},expression:"formData"}})},_=[],S=c($,g,_,!1,null,null,null,null);return S.exports});
