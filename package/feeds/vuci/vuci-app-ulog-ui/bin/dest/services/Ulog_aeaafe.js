(function(n,l){typeof exports=="object"&&typeof module<"u"?module.exports=l():typeof define=="function"&&define.amd?define(l):(n=typeof globalThis<"u"?globalThis:n||self,n["services/Ulog_js"]=l())})(this,function(){"use strict";function n(i,e,s,d,t,u,h,v){var r=typeof i=="function"?i.options:i;e&&(r.render=e,r.staticRenderFns=s,r._compiled=!0),d&&(r.functional=!0),u&&(r._scopeId="data-v-"+u);var a;if(h?(a=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__<"u"&&(o=__VUE_SSR_CONTEXT__),t&&t.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(h)},r._ssrRegister=a):t&&(a=v?function(){t.call(this,(r.functional?this.parent:this).$root.$options.shadowRoot)}:t),a)if(r.functional){r._injectStyles=a;var _=r.render;r.render=function(g,c){return a.call(c),_(g,c)}}else{var f=r.beforeCreate;r.beforeCreate=f?[].concat(f,a):[a]}return{exports:i,options:r}}const l={data(){return{extras:[["none",this.$t("No extra information")],["mac",this.$t("MAC address")],["serial",this.$t("Serial number")],["custom",this.$t("Custom string")]],uploadIntervals:[["1",this.$t("1 hour")],["2",this.$t("2 hours")],["4",this.$t("4 hours")],["8",this.$t("8 hours")],["12",this.$t("12 hours")],["24",this.$t("24 hours")]],weekdays:[["mon",this.$t("Monday")],["tue",this.$t("Tuesday")],["wed",this.$t("Wednesday")],["thu",this.$t("Thursday")],["fri",this.$t("Friday")],["sat",this.$t("Saturday")],["sun",this.$t("Sunday")]],tabs:[{tab:"server",title:this.$t("FTP Server")},{tab:"upload",title:this.$t("Upload Settings")}],modes:[["0",this.$t("Interval")],["1",this.$t("Fixed")]],networkOptions:[],isRequired:!1,isPasswordSet:!1,passSetPlaceholder:this.$t("Password is set")}},methods:{extraLoad(i){this.isRequired=i.ulog[0].enabled==="1"},loadNetworks(i){return this.$axios.get("/api/ulog/available_interfaces/options").then(({data:e})=>(this.networkOptions=e.network,this.isPasswordSet=i.ulog[0].password==="set",i.ulog[0].password="",i)).catch(()=>{this.$message.error(this.$t("Failed to load network options"))})},updateRequire(i){this.isRequired=i.uciSection.enabled==="1"},onAfterSave(i,e){this.isPasswordSet=e.data.password==="set",e.data.password="",this.$set(e.data,"require_password",this.isPasswordSet?"1":"0")},validatePath(i){return/(\/)$/.test(i)||/(\\)$/.test(i)?/\/(?=\/)/.test(i)||/\\(?=\\)/.test(i)?{isValid:!1,message:this.$t("Value can not contain more than one consecutive slash.")}:!(/^[^\\]+(\/)$/.test(i)||/^[^/]+(\\)$/.test(i))&&i.length>1?{isValid:!1,message:this.$t('Only one type of slash ("/" or "\\") can be used in a value.')}:{isValid:!0}:{isValid:!1,message:this.$t('Value should end with a slash ("/" or "\\").')}}}};var p=function(){var e=this,s=e._self._c;return s("vuci-form",{attrs:{config:"ulogd","after-load":e.loadNetworks,"extra-load":e.extraLoad,"bulk-request":""},scopedSlots:e._u([{key:"default",fn:function({uciData:d}){return[s("vuci-named-section",{attrs:{"uci-data":d,name:"global",title:e.$t("Traffic Logging settings"),"data-key":"ulogd",endpoints:[{endpoint:"ulog/config"}]},scopedSlots:e._u([{key:"default",fn:function({s:t}){return[s("vuci-form-item-switch",{attrs:{"uci-section":t,name:"enabled",label:e.$t("Enable"),help:e.$t("Enable traffic logging")},on:{change:e.updateRequire}}),s("vuci-form-item-select",{attrs:{"uci-section":t,name:"network",label:e.$t("Networks"),options:e.networkOptions,multiple:"",required:""}})]}}],null,!0)}),s("vuci-named-section",{attrs:{"uci-data":d,name:"ftp",title:e.$t("FTP Settings"),"data-key":"ulog",endpoints:[{endpoint:"ulog/ftp/config"}],"after-save":e.onAfterSave},scopedSlots:e._u([{key:"default",fn:function({s:t}){return[s("tlt-tabs",{attrs:{tabs:e.tabs},scopedSlots:e._u([{key:"server",fn:function(){return[s("vuci-form-item-input",{attrs:{"uci-section":t,name:"host",label:e.$t("Server address"),help:e.$t("The domain name or IP address of the server"),rules:"host",placeholder:"your.ftp.server",required:e.isRequired}}),s("vuci-form-item-input",{attrs:{"uci-section":t,name:"username",label:e.$t("Username"),help:e.$t("The username of the FTP server that will be used for logs uploading"),rules:"credentials_validate",maxlength:"512"}}),s("vuci-form-item-switch",{attrs:{name:"require_password","uci-section":t,label:e.$t("Require password"),initial:e.isPasswordSet?"1":"0","no-write":""}}),s("vuci-form-item-input",{attrs:{"uci-section":t,name:"password",label:e.$t("Password"),help:e.$t("The password of the FTP server that will be used for logs uploading"),rules:"credentials_validate",maxlength:"512",depend:t.require_password==="1",required:!e.isPasswordSet&&t.require_password==="1",password:"","no-write":t.password===""&&t.require_password==="1",placeholder:e.isPasswordSet?e.passSetPlaceholder:""}}),s("vuci-form-item-input",{attrs:{"uci-section":t,name:"port",label:e.$t("Port"),help:e.$t("The TCP/IP port of the server"),rules:"port",initial:"21",placeholder:"21",required:e.isRequired}}),s("vuci-form-item-input",{attrs:{"uci-section":t,name:"remote_file_path",label:e.$t("Subfolder"),help:e.$t(`FTP server's subfolder in which received file will be stored. Entry should end with a slash (either "/" or "\\")`),rules:e.validatePath}})]},proxy:!0},{key:"upload",fn:function(){return[s("vuci-form-item-select",{attrs:{"uci-section":t,name:"extra_name_info",label:e.$t("File name extras"),help:e.$t("Extra information to be added to file name"),options:e.extras}}),s("vuci-form-item-input",{attrs:{"uci-section":t,name:"custom_string",label:e.$t("Custom string"),help:e.$t("Custom string to be added to ftp file name"),rules:"fieldvalidation('^[a-zA-Z0-9_+.\\-]+$',0)",depend:t.extra_name_info==="custom",required:e.isRequired}}),s("vuci-form-item-select",{attrs:{"uci-section":t,name:"fixed",label:e.$t("Mode"),help:e.$t("The schedule mode to be used for uploading to FTP server"),options:e.modes,initial:"0"}}),s("vuci-form-item-input",{attrs:{"uci-section":t,name:"hours",label:e.$t("Hours"),help:e.$t("Uploading will be performed on this specific time of the day. Range [0 - 23]"),rules:"irange(0,23)",depend:t.fixed==="1",required:e.isRequired}}),s("vuci-form-item-input",{attrs:{"uci-section":t,name:"minutes",label:e.$t("Minutes"),help:e.$t("Uploading will be performed on this specific time of the day. Range [0 - 59]"),rules:"irange(0,59)",depend:t.fixed==="1",required:e.isRequired}}),s("vuci-form-item-select",{attrs:{"uci-section":t,name:"interval",label:e.$t("Upload interval"),help:e.$t("Upload logs to server every x hours"),options:e.uploadIntervals,initial:"1",depend:t.fixed==="0"}}),s("vuci-form-item-select",{attrs:{"uci-section":t,name:"weekdays",label:e.$t("Days"),help:e.$t("Uploading will be performed on these days only"),options:e.weekdays,multiple:"",required:e.isRequired}})]},proxy:!0}],null,!0)})]}}],null,!0)})]}}])})},m=[],$=n(l,p,m,!1,null,null,null,null);return $.exports});
