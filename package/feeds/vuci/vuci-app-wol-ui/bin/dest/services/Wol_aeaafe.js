(function(u,f){typeof exports=="object"&&typeof module<"u"?module.exports=f():typeof define=="function"&&define.amd?define(f):(u=typeof globalThis<"u"?globalThis:u||self,u["services/Wol_js"]=f())})(this,function(){"use strict";function u(i,e,a,s,t,o,d,l){var n=typeof i=="function"?i.options:i;e&&(n.render=e,n.staticRenderFns=a,n._compiled=!0),s&&(n.functional=!0),o&&(n._scopeId="data-v-"+o);var r;if(d?(r=function(c){c=c||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!c&&typeof __VUE_SSR_CONTEXT__<"u"&&(c=__VUE_SSR_CONTEXT__),t&&t.call(this,c),c&&c._registeredComponents&&c._registeredComponents.add(d)},n._ssrRegister=r):t&&(r=l?function(){t.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:t),r)if(n.functional){n._injectStyles=r;var h=n.render;n.render=function($,p){return r.call(p),h($,p)}}else{var m=n.beforeCreate;n.beforeCreate=m?[].concat(m,r):[r]}return{exports:i,options:n}}const f={data(){return{deviceColumns:[{name:"name",label:this.$t("Name"),help:this.$t("Name for the target. The name should be unique for each configuration.")},{name:"mac",label:this.$t("MAC"),help:this.$t("Specifies the MAC address of the host to wake. The MAC address should be unique for each configuration.")},{name:"password",label:this.$t("Password"),help:this.$t("Values of specific lengths (8, 12) are accepted.")},{name:"wakeonboot",label:this.$t("Wake on Boot"),help:this.$t("Decide whether to send a Wake-On-Lan (WOL) packet when booting the system.")},{name:"wake",title:this.$t("Wake device")}],formData:{},description:this.$t('This section displays a list of devices that can be "woken up" by the device using Wake on LAN. The Wake on LAN (WOL) feature can "wake up" compliant computers from sleep mode by sending a special packet (called "magic packet") to the network interface adapter of the specified device. Click the "Add" button to add more devices.'),wolErrors:{1:this.$t("Failed to wake device"),2:this.$t("Password validation failed"),3:this.$t("Failed to wake device(s) and password validation failed for device(s)"),default:this.$t("Wol packet sending failed")},interfaces:[]}},methods:{validate(i){this.$nextTick(()=>i==null?void 0:i.vuciForm.validate())},findOtherRows(i,e){return e.filter(a=>a!==i)},noDublicateValidate(i,e){const a=e.uciSection,s=e.vuciForm.uciData.target,t={isValid:!0},o=this.findOtherRows(a,s);let d="";return o.forEach(l=>{this.fieldsOverlap(a,l)&&(d=this.$t("Configuration with MAC %s already exists").format(l.mac),t.isValid=!1)}),t.message=d,t},fieldsOverlap(i,e){return i.mac===e.mac},uniqueName(i,e){const a={isValid:!0,message:""};return e.vuciForm.uciData.target.find(t=>t.id!==e.sectionTarget&&t.name===e.model)!==void 0&&(a.message=this.$t('Configuration with name "%s" already exists').format(e.model),a.isValid=!1),a},wakeSingleDevice(i){const{id:e,name:a,mac:s,password:t,wakeonboot:o}=i;if(!a||!s){this.$message.error(this.$t("No target or MAC address specified"));return}return this.$spin(),this.$axios.put(`/api/wol/config/${e}`,{data:{name:a,mac:s,password:t,wakeonboot:o}}).then(({data:d})=>this.$axios.post("/api/wol/actions/wake_device",{data:{name:d.name,mac:d.mac}}).then(()=>{this.$message.success(this.$t("Wol Packet sent"))}).catch(l=>{var n,r,h;this.$message.error(this.wolErrors[(h=(r=(n=l==null?void 0:l.response)==null?void 0:n.data)==null?void 0:r.errors)==null?void 0:h.status]||this.wolErrors.default)})).catch(()=>{this.$message.error(this.$t("Failed to update Wol device configuration"))}).finally(()=>{this.$spin(!1)})},wakeAllDevices(){return this.$axios.post("/api/wol/actions/wake_all_devices").then(()=>{this.$message.success(this.$t("Wol Packet sent"))}).catch(()=>{this.$message.error(this.$t("Wol packet sending failed"))})},loadInterfaces(){return this.$axios.get("/api/wol/options").then(({data:i})=>{this.interfaces=i.interfaces}).catch(()=>{this.$message.error(this.$t("Failed to load interfaces data"))})}}};var v=function(){var e=this,a=e._self._c;return a("vuci-form",{attrs:{config:"etherwake","after-load":e.loadInterfaces},scopedSlots:e._u([{key:"default",fn:function({uciData:s}){return[a("vuci-named-section",{attrs:{"uci-data":s,title:e.$t("Wake on LAN configuration"),endpoints:[{endpoint:"wol/global"}],"data-key":"general"},scopedSlots:e._u([{key:"default",fn:function({s:t}){return[a("vuci-form-item-switch",{attrs:{"uci-section":t,name:"broadcast",label:e.$t("Broadcast"),help:e.$t("If checked, the WOL function sends a magic packet to the broadcast address (FF:FF:FF:FF:FF:FF)         whenever it is asked to wake a device. When you send a packet to the broadcast address it is received by all LAN devices.")}}),a("vuci-form-item-select",{attrs:{"uci-section":t,name:"interface",label:e.$t("Interface"),options:e.interfaces}}),a("vuci-form-item-button",{attrs:{"uci-section":t,name:"wakeAllDevices",label:" ",type:"text",text:e.$t("Wake all Devices")},on:{click:e.wakeAllDevices}})]}}],null,!0)}),a("vuci-typed-section",{attrs:{"uci-data":s,type:"target",title:e.$t("Wake on LAN devices"),endpoints:[{endpoint:"wol/config"}],"data-key":"target",help:e.description,columns:e.deviceColumns,addremove:""},scopedSlots:e._u([{key:"name",fn:function({s:t}){return[a("vuci-form-item-input",{attrs:{"uci-section":t,name:"name",required:"",rules:["uciname",e.uniqueName]},on:{change:e.validate}})]}},{key:"mac",fn:function({s:t}){return[a("vuci-form-item-input",{attrs:{"uci-section":t,name:"mac",rules:["macaddr",e.noDublicateValidate],required:""},on:{change:e.validate}})]}},{key:"password",fn:function({s:t}){return[a("vuci-form-item-input",{attrs:{"uci-section":t,name:"password",rules:o=>[o.hexstring,o.exact_length.bind(o,[8,12])]}})]}},{key:"wakeonboot",fn:function({s:t}){return[a("vuci-form-item-switch",{attrs:{"uci-section":t,name:"wakeonboot"}})]}},{key:"wake",fn:function({s:t}){return[a("vuci-form-item-button",{attrs:{"uci-section":t,name:"wakeSingleDevice",text:e.$t("Wake device")},on:{click:function(o){return e.wakeSingleDevice(t)}}})]}}],null,!0)})]}}]),model:{value:e.formData,callback:function(s){e.formData=s},expression:"formData"}})},k=[],w=u(f,v,k,!1,null,null,null,null);return w.exports});
