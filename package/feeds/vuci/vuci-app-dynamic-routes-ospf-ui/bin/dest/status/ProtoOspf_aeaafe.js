(function(d,l){typeof exports=="object"&&typeof module<"u"?module.exports=l():typeof define=="function"&&define.amd?define(l):(d=typeof globalThis<"u"?globalThis:d||self,d["status/ProtoOspf_js"]=l())})(this,function(){"use strict";function d(r,t,s,n,e,u,h,c){var a=typeof r=="function"?r.options:r;t&&(a.render=t,a.staticRenderFns=s,a._compiled=!0),n&&(a.functional=!0),u&&(a._scopeId="data-v-"+u);var o;if(h?(o=function(i){i=i||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!i&&typeof __VUE_SSR_CONTEXT__<"u"&&(i=__VUE_SSR_CONTEXT__),e&&e.call(this,i),i&&i._registeredComponents&&i._registeredComponents.add(h)},a._ssrRegister=o):e&&(o=c?function(){e.call(this,(a.functional?this.parent:this).$root.$options.shadowRoot)}:e),o)if(a.functional){a._injectStyles=o;var C=a.render;a.render=function($,p){return o.call(p),C($,p)}}else{var f=a.beforeCreate;a.beforeCreate=f?[].concat(f,o):[o]}return{exports:r,options:a}}const l={data(){return{cards:[],externalRoutesCards:[],firstLoad:!0,tableColumns:[{dataIndex:"ip",title:this.$t("Network")},{dataIndex:"type",title:this.$t("Route type")},{dataIndex:"rtype",title:this.$t("Router type")},{dataIndex:"cost",title:this.$t("Cost")},{dataIndex:"area",title:this.$t("Area")},{dataIndex:"via",title:this.$t("Interface")},{dataIndex:"nexthops",title:this.$t("Nexthop")}],cardsColumns:[{name:"priority",label:this.$t("Priority")},{name:"state",label:this.$t("State")},{name:"deadTimeMsecs",label:this.$t("Dead Time(s)")},{name:"address",label:this.$t("Neighbor IP")},{name:"ifaceName",label:this.$t("Interface address")},{name:"iface",label:this.$t("Interface")},{name:"retransmitCounter",label:this.$t("Retransmit counter")},{name:"requestCounter",label:this.$t("Request counter")},{name:"dbSummaryCounter",label:this.$t("Summary counter")}]}},created(){this.$spin(),this.$timer.start("getData")},methods:{getData(){return this.$axios.get("/api/ospf/status").then(r=>{if(r!=null&&r.data){const t=[],s=[];for(const[n,[e]]of Object.entries(r.data.neighbors)){const[u,h]=e.ifaceName.split(":"),c=e.address,a={priority:String(e.priority),state:e.state,deadTimeMsecs:String(e.deadTimeMsecs/1e3),address:c,ifaceName:h,iface:u,retransmitCounter:String(e.retransmitCounter),requestCounter:String(e.requestCounter),dbSummaryCounter:String(e.dbSummaryCounter)};t.push({title:n,data:a,tableData:this.getRoutes(r.data,c)}),s.push({title:this.$t("External Routes"),data:a,tableData:this.getExternalRoutes(r.data,c)})}this.cards=t,this.externalRoutesCards=s}}).catch(()=>{this.$message.error(this.$t("Failed to load ospf data"))}).finally(()=>{this.firstLoad&&(this.$spin(!1),this.firstLoad=!1)})},getRoutes(r,t){const s=[];for(const[n,e]of Object.entries(r))if(n!=="neighbors"){const[u]=e.nexthops;u.ip===t&&s.push(this.parseRoutes(n,e,u))}return s.sort((n,e)=>e.type>n.type?1:n.type>e.type?-1:0)},getExternalRoutes(r){const t=[];for(const[s,n]of Object.entries(r))if(s!=="neighbors"){const[e]=n.nexthops;n.routeType==="N E2"&&t.push(this.parseRoutes(s,n,e))}return t.sort((s,n)=>n.type>s.type?1:s.type>n.type?-1:0)},parseRoutes(r,t,s){return{id:r,ip:t.routeType==="R "?"-":r,type:t.routeType||"-",rtype:t.routerType?t.routerType.toUpperCase():"-",cost:t!=null&&t.cost?String(t.cost):"-",area:t.area||"-",via:s.via||"-",nexthops:s.ip||"-"}}},timers:{getData:{time:1e4,immediate:!0,repeat:!0}}};var m=function(){var t=this,s=t._self._c;return s("tlt-card",{attrs:{sid:"ospf_routes",title:"OSPF"}},[t.externalRoutesCards.length!==0?s("tlt-routing-card",{attrs:{cards:t.externalRoutesCards,"table-columns":t.tableColumns}}):t._e(),t.cards.length!==0?s("tlt-routing-card",{attrs:{cards:t.cards,"table-columns":t.tableColumns,"cards-columns":t.cardsColumns}}):s("p",[t._v(" "+t._s(t.$t("There are no neighbours"))+" ")])],1)},_=[],y=d(l,m,_,!1,null,null,null,null);return y.exports});
