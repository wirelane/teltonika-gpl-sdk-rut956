(function(u,p){typeof exports=="object"&&typeof module<"u"?module.exports=p():typeof define=="function"&&define.amd?define(p):(u=typeof globalThis<"u"?globalThis:u||self,u["status/ProtoBgp_js"]=p())})(this,function(){"use strict";function u(e,o,n,c,i,l,f,t){var s=typeof e=="function"?e.options:e;o&&(s.render=o,s.staticRenderFns=n,s._compiled=!0),c&&(s.functional=!0),l&&(s._scopeId="data-v-"+l);var r;if(f?(r=function(a){a=a||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!a&&typeof __VUE_SSR_CONTEXT__<"u"&&(a=__VUE_SSR_CONTEXT__),i&&i.call(this,a),a&&a._registeredComponents&&a._registeredComponents.add(f)},s._ssrRegister=r):i&&(r=t?function(){i.call(this,(s.functional?this.parent:this).$root.$options.shadowRoot)}:i),r)if(s.functional){s._injectStyles=r;var h=s.render;s.render=function($,d){return r.call(d),h($,d)}}else{var m=s.beforeCreate;s.beforeCreate=m?[].concat(m,r):[r]}return{exports:e,options:s}}const p={data(){return{cards:[],firstLoad:!0,tableColumns:[{dataIndex:"vfr",title:this.$t("VRF")},{dataIndex:"pathFrom",title:this.$t("Path from")},{dataIndex:"network",title:this.$t("Network")},{dataIndex:"valid",title:this.$t("Used")}]}},computed:{cardsColumns(){const e=[{name:"bgpState",label:this.$t("State")},{name:"remoteAs",label:this.$t("Remote AS")},{name:"remoteRouterId",label:this.$t("Remote ID")},{name:"localAs",label:this.$t("Local AS")},{name:"hostLocal",label:this.$t("Local host")},{name:"acceptedPrefixCounter",label:this.$t("Accepted prefixes")},{name:"bgpTimerUpString",label:this.$t("Uptime")}];return this.$store.state.device.startsWith("TRB5")||e.push({name:"updates",label:this.$t("Updates RX/TX")},{name:"total",label:this.$t("Total RX/TX")}),e}},created(){this.$spin(),this.$timer.start("getData")},methods:{getData(){return this.$axios.get("/api/bgp/status").then(({data:e})=>{var o,n,c,i;if(e){const l=[],f=Object.keys(e).length;for(let t=0;t<f;t++)if(String(Object.keys(e)[t].toLowerCase())!=="default"){const s=e[Object.keys(e)[t]].messageStats.updatesSent&&e[Object.keys(e)[t]].messageStats.updatesRecv?`${e[Object.keys(e)[t]].messageStats.updatesSent}/${e[Object.keys(e)[t]].messageStats.updatesRecv}`:"-",r=e[Object.keys(e)[t]].messageStats.totalSent&&e[Object.keys(e)[t]].messageStats.totalRecv?`${e[Object.keys(e)[t]].messageStats.totalSent}/${e[Object.keys(e)[t]].messageStats.totalRecv}`:"-",h={bgpState:e[Object.keys(e)[t]].bgpState||"-",remoteAs:e[Object.keys(e)[t]].remoteAs||"-",remoteRouterId:e[Object.keys(e)[t]].remoteRouterId||"-",localAs:e[Object.keys(e)[t]].localAs||"-",hostLocal:e[Object.keys(e)[t]].hostLocal||"-",acceptedPrefixCounter:((n=(o=e[Object.keys(e)[t]].addressFamilyInfo)==null?void 0:o.ipv4Unicast)==null?void 0:n.acceptedPrefixCounter)||((i=(c=e[Object.keys(e)[t]].addressFamilyInfo)==null?void 0:c["IPv4 Unicast"])==null?void 0:i.acceptedPrefixCounter)||"-",bgpTimerUpString:e[Object.keys(e)[t]].bgpTimerUpString||"-",updates:s,total:r};l.push({title:Object.keys(e)[t],data:h,tableData:this.getTableData(e.default||e.Default,Object.keys(e)[t])})}this.cards=l}}).catch(()=>{this.$message.error(this.$t("Failed to load bgp data"))}).finally(()=>{this.firstLoad&&(this.$spin(!1),this.firstLoad=!1)})},getTableData(e,o){const n=[],c=String(e.vrfId),i=String(e.vrfName),l=c==null?void 0:c.concat("/",i),f=Object.keys(e.routes);for(let t=0;t<f.length;t++){const s=e.routes[f[t]][0],r=s.prefix,h=s.prefixLen;s.peerId===o&&n.push({vfr:l,pathFrom:s.pathFrom||"-",network:(r==null?void 0:r.concat("/",h))||"-",valid:s.valid||"-"})}return n}},timers:{getData:{time:1e4,immediate:!0,repeat:!0}}};var b=function(){var o=this,n=o._self._c;return n("tlt-card",{attrs:{sid:"bgp_routes",title:"BGP"}},[o.cards.length!==0?n("tlt-routing-card",{attrs:{cards:o.cards,"table-columns":o.tableColumns,"cards-columns":o.cardsColumns}}):n("div",[o._v(" "+o._s(o.$t("There are no neighbours"))+" ")])],1)},g=[],_=u(p,b,g,!1,null,null,null,null);return _.exports});
