Index: netifd-2024-01-04-c18cc79d/scripts/netifd-wireless.sh
===================================================================
--- netifd-2024-01-04-c18cc79d.orig/scripts/netifd-wireless.sh
+++ netifd-2024-01-04-c18cc79d/scripts/netifd-wireless.sh
@@ -385,12 +385,12 @@ _wdev_common_iface_config() {
 }
 
 _wdev_common_vlan_config() {
-	config_add_string name vid iface
+	config_add_string name vid iface psk_group
 	config_add_boolean bridge_isolate
 }
 
 _wdev_common_station_config() {
-	config_add_string mac key vid iface
+	config_add_string mac key vid iface psk_group
 }
 
 init_wireless_driver() {
Index: netifd-2024-01-04-c18cc79d/config.c
===================================================================
--- netifd-2024-01-04-c18cc79d.orig/config.c
+++ netifd-2024-01-04-c18cc79d/config.c
@@ -631,6 +631,7 @@ config_parse_wireless_interface(struct w
 	blob_buf_init(&b, 0);
 	uci_to_blob(&b, s, wdev->drv->interface.config);
 
+	const char *vif_psk_group = uci_lookup_option_string(uci_ctx, s, "psk_group");
 	const char *wifi_id = uci_lookup_option_string(uci_ctx, s, "wifi_id");
 	config_parse_wireless_interface_extra(&b, wifi_id, "nai-realm");
 	config_parse_wireless_interface_extra(&b, wifi_id, "venue");
@@ -652,26 +653,44 @@ config_parse_wireless_interface(struct w
 	uci_foreach_element(&uci_wireless->sections, f) {
 		struct uci_section *cur = uci_to_section(f);
 		const char *vif_name;
+		const char *vlan_psk_group;
 
 		if (strcmp(cur->type, "wifi-vlan") != 0)
 			continue;
 
 		vif_name = uci_lookup_option_string(uci_ctx, cur, "iface");
+		vlan_psk_group = uci_lookup_option_string(uci_ctx, cur, "psk_group");
+
 		if (vif_name && strcmp(s->e.name, vif_name))
 			continue;
+
+		if ((vif_psk_group && !vlan_psk_group) ||
+			(!vif_psk_group && vlan_psk_group) ||
+			(vif_psk_group && vlan_psk_group && strcmp(vif_psk_group, vlan_psk_group)))
+			continue;
+
 		config_parse_wireless_vlan(vif, cur);
 	}
 
 	uci_foreach_element(&uci_wireless->sections, f) {
 		struct uci_section *cur = uci_to_section(f);
 		const char *vif_name;
+		const char *sta_psk_group;
 
 		if (strcmp(cur->type, "wifi-station") != 0)
 			continue;
 
 		vif_name = uci_lookup_option_string(uci_ctx, cur, "iface");
+		sta_psk_group = uci_lookup_option_string(uci_ctx, cur, "psk_group");
+
 		if (vif_name && strcmp(s->e.name, vif_name))
 			continue;
+
+		if ((vif_psk_group && !sta_psk_group) ||
+			(!vif_psk_group && sta_psk_group) ||
+			(vif_psk_group && sta_psk_group && strcmp(vif_psk_group, sta_psk_group)))
+			continue;
+
 		config_parse_wireless_station(vif, cur);
 	}
 
